!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("ramda"),require("route-parser"),require("gun-suppressor"),require("gun/gun"),require("gun/sea")):"function"==typeof define&&define.amd?define("gun-suppressor-sear",["ramda","route-parser","gun-suppressor","gun/gun","gun/sea"],r):"object"==typeof exports?exports["gun-suppressor-sear"]=r(require("ramda"),require("route-parser"),require("gun-suppressor"),require("gun/gun"),require("gun/sea")):e["gun-suppressor-sear"]=r(e.ramda,e["route-parser"],e["gun-suppressor"],e["gun/gun"],e["gun/sea"])}("undefined"!=typeof self?self:this,function(e,r,t,n,o){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)t.d(n,o,function(r){return e[r]}.bind(null,o));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";(function(e){Object.defineProperty(r,"__esModule",{value:!0}),r.initAjv=r.read=r.PERMISSIVE_SCHEMA=r.PERMISSIVE_NODE_SCHEMA=r.AUTH_SCHEMA=void 0;var n,o=t(2),i=(n=t(3))&&n.__esModule?n:{default:n},u=t(4);e.Gun=e.Gun||t(5);var s=t(6),a=s.verify,p=s.opt,f=p.pack,d=p.unpack,c=new i.default("~:authorId"),l=new i.default("*stuff~:authorId."),h={seaAlias:{type:"string",maxLength:512},SEAAlias:{title:"Gun SEA Alias",$async:!0,soul:{pattern:"~@:alias",properties:{alias:{$ref:"schema.json#/definitions/seaAlias"}},required:["alias"]},additionalProperties:{edgeMatchesKey:!0,anyOf:[{$ref:"#/definitions/SEAAuthorEdge"}]}},seaAuthorId:{type:"string",maxLength:128},seaAuthObj:{oneOf:[{type:"object",properties:{ek:{type:"string"},s:{type:"string"}}},{type:"string"}]},SEAAuthor:{title:"Gun SEA Author",$async:!0,properties:{pub:{$ref:"#/definitions/seaAuthorId"},epub:{sea:{type:"string"}},alias:{sea:{$ref:"schema.json#/definitions/seaAlias"}},auth:{sea:{$ref:"schema.json#/definitions/seaAuthObj"}}},additionalProperties:{sea:{anyOf:[{$ref:"schema.json#/definitions/GunEdge"},{$ref:"schema.json#/definitions/seaAuthObj"},{type:"null"},{type:"string"},{type:"number"},{type:"boolean"}]}},soul:{pattern:"~:authorId",properties:{authorId:{$ref:"schema.json#/definitions/seaAuthorId"}},required:["authorId"]}}};r.AUTH_SCHEMA=h;var y={title:"Gun SEA Node",description:"Any SEA node supported by gun",$async:!0,soul:{pattern:"*path~:authorId.",properties:{path:{type:"string"},authorId:{$ref:"schema.json#/definitions/seaAuthorId"}},required:["path","authorId"]},additionalProperties:{".*":{sea:{anyOf:[{$ref:"schema.json#/definitions/GunNodeMeta"},{$ref:"schema.json#/definitions/GunEdge"},{type:"null"},{type:"string"},{type:"number"},{type:"boolean"}]}}}};r.PERMISSIVE_NODE_SCHEMA=y;var g={...h,SEANode:y,...u.PERMISSIVE_SCHEMA};r.PERMISSIVE_SCHEMA=g;var A=function(e,r){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a(f(e[r],r,e,(0,o.path)(["_","#"],e)),t).then(function(t){if(void 0===t)throw new Error("invalid sea data");return d(t,r,e)})};r.read=A;var b=function(e){return function(r,t,n,i,u,s){var a=(0,o.path)(["_","#"],u);if("_"===s)return!0;var p=(l.match(a)||c.match(a)||{}).authorId;if(!p)return!1;if(a==="~".concat(p)&&"pub"===s)return t===p;var f,d,h,y,g=e.compile({additionalProperties:!0,properties:(f={},d=s,h=r,d in f?Object.defineProperty(f,d,{value:h,enumerable:!0,configurable:!0,writable:!0}):f[d]=h,f)});return A(u,s,p).then(function(e){return y=e}).then(function(e){return(0,o.assoc)(s,e,u)}).catch(function(e){return console.error("key err",a,s,e.stack||e),!1}).then(function(e){return e?Promise.resolve(g()).then(function(e){return e||console.error("sea validation err",a,s,y,g.errors,n),e}):(delete u[s],delete((0,o.path)(["_",">"],u)||{})[s],console.error("sea prop err",a,s,y,n),e)})}},m=(0,o.compose)(function(e){return e.addKeyword("sea",{async:!0,modifying:!0,validate:b(e)}),e},u.initAjv);r.initAjv=m}).call(this,t(1))},function(e,r){var t;t=function(){return this}();try{t=t||new Function("return this")()}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(r,t){r.exports=e},function(e,t){e.exports=r},function(e,r){e.exports=t},function(e,r){e.exports=n},function(e,r){e.exports=o}])});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ndW4tc3VwcHJlc3Nvci1zZWFyL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9ndW4tc3VwcHJlc3Nvci1zZWFyL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2d1bi1zdXBwcmVzc29yLXNlYXIvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vZ3VuLXN1cHByZXNzb3Itc2Vhci8od2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanMiLCJ3ZWJwYWNrOi8vZ3VuLXN1cHByZXNzb3Itc2Vhci9leHRlcm5hbCBcInJhbWRhXCIiLCJ3ZWJwYWNrOi8vZ3VuLXN1cHByZXNzb3Itc2Vhci9leHRlcm5hbCBcInJvdXRlLXBhcnNlclwiIiwid2VicGFjazovL2d1bi1zdXBwcmVzc29yLXNlYXIvZXh0ZXJuYWwgXCJndW4tc3VwcHJlc3NvclwiIiwid2VicGFjazovL2d1bi1zdXBwcmVzc29yLXNlYXIvZXh0ZXJuYWwgXCJndW4vZ3VuXCIiLCJ3ZWJwYWNrOi8vZ3VuLXN1cHByZXNzb3Itc2Vhci9leHRlcm5hbCBcImd1bi9zZWFcIiJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJyZXF1aXJlIiwiZGVmaW5lIiwiYW1kIiwic2VsZiIsInRoaXMiLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18yX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18zX18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX180X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX181X18iLCJfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX182X18iLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiX3JhbWRhIiwiX3JvdXRlUGFyc2VyIiwiX2d1blN1cHByZXNzb3IiLCJnbG9iYWwiLCJHdW4iLCJ2ZXJpZnkiLCJvcHQiLCJwYWNrIiwidW5wYWNrIiwic2VhQXV0aG9yUm91dGUiLCJkZWZhdWx0Iiwic2VhU291bFJvdXRlIiwiQVVUSF9TQ0hFTUEiLCJzZWFBbGlhcyIsInR5cGUiLCJtYXhMZW5ndGgiLCJTRUFBbGlhcyIsInRpdGxlIiwiJGFzeW5jIiwic291bCIsInBhdHRlcm4iLCJwcm9wZXJ0aWVzIiwiYWxpYXMiLCIkcmVmIiwicmVxdWlyZWQiLCJhZGRpdGlvbmFsUHJvcGVydGllcyIsImVkZ2VNYXRjaGVzS2V5IiwiYW55T2YiLCJzZWFBdXRob3JJZCIsInNlYUF1dGhPYmoiLCJvbmVPZiIsImVrIiwiU0VBQXV0aG9yIiwicHViIiwiZXB1YiIsInNlYSIsImF1dGgiLCJhdXRob3JJZCIsIlBFUk1JU1NJVkVfTk9ERV9TQ0hFTUEiLCJkZXNjcmlwdGlvbiIsInBhdGgiLCIuKiIsIlBFUk1JU1NJVkVfU0NIRU1BIiwiU0VBTm9kZSIsInJlYWQiLCJkYXRhIiwicGFpciIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsInRoZW4iLCJFcnJvciIsInZhbGlkYXRlU2VhUHJvcGVydHkiLCJhanYiLCJzY2hlbWEiLCJwU2NoZW1hIiwiY1BhdGgiLCJwYXJlbnREYXRhIiwia2V5SW5QYXJlbnQiLCJtYXRjaCIsImNvbmNhdCIsInJlc3VsdCIsInZhbGlkYXRlIiwiY29tcGlsZSIsInJlcyIsImFzc29jIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJzdGFjayIsIlByb21pc2UiLCJyZXNvbHZlIiwiaXNWYWxpZCIsImVycm9ycyIsImluaXRBanYiLCJjb21wb3NlIiwiYWRkS2V5d29yZCIsImFzeW5jIiwibW9kaWZ5aW5nIiwiZyIsIkZ1bmN0aW9uIiwiZSIsIndpbmRvdyJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxpQkFBQUMsU0FBQSxpQkFBQUMsT0FDQUEsT0FBQUQsUUFBQUQsRUFBQUcsUUFBQSxTQUFBQSxRQUFBLGdCQUFBQSxRQUFBLGtCQUFBQSxRQUFBLFdBQUFBLFFBQUEsWUFDQSxtQkFBQUMsZUFBQUMsSUFDQUQsT0FBQSxvRkFBQUosR0FDQSxpQkFBQUMsUUFDQUEsUUFBQSx1QkFBQUQsRUFBQUcsUUFBQSxTQUFBQSxRQUFBLGdCQUFBQSxRQUFBLGtCQUFBQSxRQUFBLFdBQUFBLFFBQUEsWUFFQUosRUFBQSx1QkFBQUMsRUFBQUQsRUFBQSxNQUFBQSxFQUFBLGdCQUFBQSxFQUFBLGtCQUFBQSxFQUFBLFdBQUFBLEVBQUEsWUFSQSxDQVNDLG9CQUFBTyxVQUFBQyxLQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBQ0QsbUJDVEEsSUFBQUMsRUFBQSxHQUdBLFNBQUFDLEVBQUFDLEdBR0EsR0FBQUYsRUFBQUUsR0FDQSxPQUFBRixFQUFBRSxHQUFBZCxRQUdBLElBQUFDLEVBQUFXLEVBQUFFLEdBQUEsQ0FDQUMsRUFBQUQsRUFDQUUsR0FBQSxFQUNBaEIsUUFBQSxJQVVBLE9BTkFpQixFQUFBSCxHQUFBSSxLQUFBakIsRUFBQUQsUUFBQUMsSUFBQUQsUUFBQWEsR0FHQVosRUFBQWUsR0FBQSxFQUdBZixFQUFBRCxRQTBEQSxPQXJEQWEsRUFBQU0sRUFBQUYsRUFHQUosRUFBQU8sRUFBQVIsRUFHQUMsRUFBQVEsRUFBQSxTQUFBckIsRUFBQXNCLEVBQUFDLEdBQ0FWLEVBQUFXLEVBQUF4QixFQUFBc0IsSUFDQUcsT0FBQUMsZUFBQTFCLEVBQUFzQixFQUFBLENBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDVixF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YXJCLEdBQ2xDYSxLQUFLLFNBQUFjLEdBQUcsT0FBS0gsRUFBU0csSUFDdEJkLEtBQUssU0FBQWMsR0FBRyxPQUFJLEVBQUFoRSxFQUFBaUUsT0FBTVAsRUFBYU0sRUFBS1AsS0FDcENTLE1BQU0sU0FBQUMsR0FFTCxPQURBQyxRQUFRQyxNQUFNLFVBQVdsRCxFQUFNdUMsRUFBYVMsRUFBSUcsT0FBU0gsSUFDbEQsSUFFUmpCLEtBQUssU0FBQWMsR0FDSixPQUFLQSxFQU1FTyxRQUFRQyxRQUFRVixLQUFZWixLQUFLLFNBQUF1QixHQVd0QyxPQVZLQSxHQUNITCxRQUFRQyxNQUNOLHFCQUNBbEQsRUFDQXVDLEVBQ0FHLEVBQ0FDLEVBQVNZLE9BQ1RuQixHQUdHa0IsWUFoQkFoQixFQUFXQyxXQUNWLEVBQUExRCxFQUFBd0MsTUFBSyxDQUFDLElBQUssS0FBTWlCLElBQWUsSUFBSUMsR0FDNUNVLFFBQVFDLE1BQU0sZUFBZ0JsRCxFQUFNdUMsRUFBYUcsRUFBUU4sR0FDbERTLE9Ba0JGVyxHQUFVLEVBQUEzRSxFQUFBNEUsU0FDckIsU0FBQXZCLEdBTUUsT0FMQUEsRUFBSXdCLFdBQVcsTUFBTyxDQUNwQkMsT0FBTyxFQUNQQyxXQUFXLEVBQ1hqQixTQUFVVixFQUFvQkMsS0FFekJBLEdBUFluRCxFQUFBeUUsc0RDM0x2QixJQUFBSyxFQUdBQSxFQUFBLFdBQ0EsT0FBQXpILEtBREEsR0FJQSxJQUVBeUgsS0FBQSxJQUFBQyxTQUFBLGlCQUNDLE1BQUFDLEdBRUQsaUJBQUFDLFNBQUFILEVBQUFHLFFBT0FqSSxFQUFBRCxRQUFBK0gsaUJDbkJBOUgsRUFBQUQsUUFBQU8saUJDQUFOLEVBQUFELFFBQUFRLGlCQ0FBUCxFQUFBRCxRQUFBUyxpQkNBQVIsRUFBQUQsUUFBQVUsaUJDQUFULEVBQUFELFFBQUFXIiwiZmlsZSI6Imd1bi1zdXBwcmVzc29yLXNlYXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicmFtZGFcIiksIHJlcXVpcmUoXCJyb3V0ZS1wYXJzZXJcIiksIHJlcXVpcmUoXCJndW4tc3VwcHJlc3NvclwiKSwgcmVxdWlyZShcImd1bi9ndW5cIiksIHJlcXVpcmUoXCJndW4vc2VhXCIpKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwiZ3VuLXN1cHByZXNzb3Itc2VhclwiLCBbXCJyYW1kYVwiLCBcInJvdXRlLXBhcnNlclwiLCBcImd1bi1zdXBwcmVzc29yXCIsIFwiZ3VuL2d1blwiLCBcImd1bi9zZWFcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiZ3VuLXN1cHByZXNzb3Itc2VhclwiXSA9IGZhY3RvcnkocmVxdWlyZShcInJhbWRhXCIpLCByZXF1aXJlKFwicm91dGUtcGFyc2VyXCIpLCByZXF1aXJlKFwiZ3VuLXN1cHByZXNzb3JcIiksIHJlcXVpcmUoXCJndW4vZ3VuXCIpLCByZXF1aXJlKFwiZ3VuL3NlYVwiKSk7XG5cdGVsc2Vcblx0XHRyb290W1wiZ3VuLXN1cHByZXNzb3Itc2VhclwiXSA9IGZhY3Rvcnkocm9vdFtcInJhbWRhXCJdLCByb290W1wicm91dGUtcGFyc2VyXCJdLCByb290W1wiZ3VuLXN1cHByZXNzb3JcIl0sIHJvb3RbXCJndW4vZ3VuXCJdLCByb290W1wiZ3VuL3NlYVwiXSk7XG59KSh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDogdGhpcywgZnVuY3Rpb24oX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fMl9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18zX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfXzRfXywgX19XRUJQQUNLX0VYVEVSTkFMX01PRFVMRV9fNV9fLCBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX182X18pIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMCk7XG4iLCIvKiBnbG9iYWxzIFByb21pc2UgKi9cbmltcG9ydCB7IGNvbXBvc2UsIHBhdGgsIGFzc29jIH0gZnJvbSBcInJhbWRhXCI7XG5pbXBvcnQgUm91dGUgZnJvbSBcInJvdXRlLXBhcnNlclwiO1xuaW1wb3J0IHtcbiAgUEVSTUlTU0lWRV9TQ0hFTUEgYXMgR1VOX1BFUk1JU1NJVkVfU0NIRU1BLFxuICBpbml0QWp2IGFzIGFqdkJhc2VJbml0XG59IGZyb20gXCJndW4tc3VwcHJlc3NvclwiO1xuXG5nbG9iYWwuR3VuID0gZ2xvYmFsLkd1biB8fCByZXF1aXJlKFwiZ3VuL2d1blwiKTtcbmNvbnN0IHtcbiAgdmVyaWZ5LFxuICBvcHQ6IHsgcGFjaywgdW5wYWNrIH1cbn0gPSByZXF1aXJlKFwiZ3VuL3NlYVwiKTtcblxuY29uc3QgTUFYX0FVVEhPUl9BTElBU19TSVpFID0gNTEyO1xuY29uc3QgTUFYX0FVVEhPUl9JRF9TSVpFID0gMTI4OyAvLyA/Pz9cbmNvbnN0IGF1dGhvclBhdHRlcm4gPSBcIn46YXV0aG9ySWRcIjtcbmNvbnN0IHNlYUF1dGhvclJvdXRlID0gbmV3IFJvdXRlKGF1dGhvclBhdHRlcm4pO1xuY29uc3Qgc2VhU291bFJvdXRlID0gbmV3IFJvdXRlKFwiKnN0dWZmfjphdXRob3JJZC5cIik7XG5cbmV4cG9ydCBjb25zdCBBVVRIX1NDSEVNQSA9IHtcbiAgc2VhQWxpYXM6IHsgdHlwZTogXCJzdHJpbmdcIiwgbWF4TGVuZ3RoOiBNQVhfQVVUSE9SX0FMSUFTX1NJWkUgfSxcbiAgU0VBQWxpYXM6IHtcbiAgICB0aXRsZTogXCJHdW4gU0VBIEFsaWFzXCIsXG4gICAgJGFzeW5jOiB0cnVlLFxuICAgIHNvdWw6IHtcbiAgICAgIHBhdHRlcm46IFwifkA6YWxpYXNcIixcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYWxpYXM6IHsgJHJlZjogXCJzY2hlbWEuanNvbiMvZGVmaW5pdGlvbnMvc2VhQWxpYXNcIiB9XG4gICAgICB9LFxuICAgICAgcmVxdWlyZWQ6IFtcImFsaWFzXCJdXG4gICAgfSxcbiAgICBhZGRpdGlvbmFsUHJvcGVydGllczoge1xuICAgICAgZWRnZU1hdGNoZXNLZXk6IHRydWUsXG4gICAgICBhbnlPZjogW3sgJHJlZjogXCIjL2RlZmluaXRpb25zL1NFQUF1dGhvckVkZ2VcIiB9XVxuICAgIH1cbiAgfSxcbiAgc2VhQXV0aG9ySWQ6IHsgdHlwZTogXCJzdHJpbmdcIiwgbWF4TGVuZ3RoOiBNQVhfQVVUSE9SX0lEX1NJWkUgfSxcbiAgc2VhQXV0aE9iajoge1xuICAgIG9uZU9mOiBbXG4gICAgICB7XG4gICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICBlazogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgczogeyB0eXBlOiBcInN0cmluZ1wiIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgfVxuICAgIF1cbiAgfSxcbiAgU0VBQXV0aG9yOiB7XG4gICAgdGl0bGU6IFwiR3VuIFNFQSBBdXRob3JcIixcbiAgICAkYXN5bmM6IHRydWUsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgcHViOiB7ICRyZWY6IFwiIy9kZWZpbml0aW9ucy9zZWFBdXRob3JJZFwiIH0sXG4gICAgICBlcHViOiB7IHNlYTogeyB0eXBlOiBcInN0cmluZ1wiIH0gfSxcbiAgICAgIGFsaWFzOiB7IHNlYTogeyAkcmVmOiBcInNjaGVtYS5qc29uIy9kZWZpbml0aW9ucy9zZWFBbGlhc1wiIH0gfSxcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgc2VhOiB7ICRyZWY6IFwic2NoZW1hLmpzb24jL2RlZmluaXRpb25zL3NlYUF1dGhPYmpcIiB9XG4gICAgICB9XG4gICAgfSxcbiAgICBhZGRpdGlvbmFsUHJvcGVydGllczoge1xuICAgICAgc2VhOiB7XG4gICAgICAgIGFueU9mOiBbXG4gICAgICAgICAgeyAkcmVmOiBcInNjaGVtYS5qc29uIy9kZWZpbml0aW9ucy9HdW5FZGdlXCIgfSxcbiAgICAgICAgICB7ICRyZWY6IFwic2NoZW1hLmpzb24jL2RlZmluaXRpb25zL3NlYUF1dGhPYmpcIiB9LFxuICAgICAgICAgIHsgdHlwZTogXCJudWxsXCIgfSxcbiAgICAgICAgICB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICB7IHR5cGU6IFwibnVtYmVyXCIgfSxcbiAgICAgICAgICB7IHR5cGU6IFwiYm9vbGVhblwiIH1cbiAgICAgICAgXVxuICAgICAgfVxuICAgIH0sXG4gICAgc291bDoge1xuICAgICAgcGF0dGVybjogYXV0aG9yUGF0dGVybixcbiAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgYXV0aG9ySWQ6IHsgJHJlZjogXCJzY2hlbWEuanNvbiMvZGVmaW5pdGlvbnMvc2VhQXV0aG9ySWRcIiB9XG4gICAgICB9LFxuICAgICAgcmVxdWlyZWQ6IFtcImF1dGhvcklkXCJdXG4gICAgfVxuICB9XG59O1xuXG5leHBvcnQgY29uc3QgUEVSTUlTU0lWRV9OT0RFX1NDSEVNQSA9IHtcbiAgdGl0bGU6IFwiR3VuIFNFQSBOb2RlXCIsXG4gIGRlc2NyaXB0aW9uOiBcIkFueSBTRUEgbm9kZSBzdXBwb3J0ZWQgYnkgZ3VuXCIsXG4gICRhc3luYzogdHJ1ZSxcblxuICBzb3VsOiB7XG4gICAgcGF0dGVybjogXCIqcGF0aH46YXV0aG9ySWQuXCIsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgcGF0aDogeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICBhdXRob3JJZDogeyAkcmVmOiBcInNjaGVtYS5qc29uIy9kZWZpbml0aW9ucy9zZWFBdXRob3JJZFwiIH1cbiAgICB9LFxuICAgIHJlcXVpcmVkOiBbXCJwYXRoXCIsIFwiYXV0aG9ySWRcIl1cbiAgfSxcblxuICBhZGRpdGlvbmFsUHJvcGVydGllczoge1xuICAgIFwiLipcIjoge1xuICAgICAgc2VhOiB7XG4gICAgICAgIGFueU9mOiBbXG4gICAgICAgICAgeyAkcmVmOiBcInNjaGVtYS5qc29uIy9kZWZpbml0aW9ucy9HdW5Ob2RlTWV0YVwiIH0sXG4gICAgICAgICAgeyAkcmVmOiBcInNjaGVtYS5qc29uIy9kZWZpbml0aW9ucy9HdW5FZGdlXCIgfSxcbiAgICAgICAgICB7IHR5cGU6IFwibnVsbFwiIH0sXG4gICAgICAgICAgeyB0eXBlOiBcInN0cmluZ1wiIH0sXG4gICAgICAgICAgeyB0eXBlOiBcIm51bWJlclwiIH0sXG4gICAgICAgICAgeyB0eXBlOiBcImJvb2xlYW5cIiB9XG4gICAgICAgIF1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBQRVJNSVNTSVZFX1NDSEVNQSA9IHtcbiAgLi4uQVVUSF9TQ0hFTUEsXG4gIFNFQU5vZGU6IFBFUk1JU1NJVkVfTk9ERV9TQ0hFTUEsXG4gIC4uLkdVTl9QRVJNSVNTSVZFX1NDSEVNQVxufTtcblxuZXhwb3J0IGNvbnN0IHJlYWQgPSAoZGF0YSwga2V5LCBwYWlyID0gZmFsc2UpID0+XG4gIHZlcmlmeShwYWNrKGRhdGFba2V5XSwga2V5LCBkYXRhLCBwYXRoKFtcIl9cIiwgXCIjXCJdLCBkYXRhKSksIHBhaXIpLnRoZW4ociA9PiB7XG4gICAgaWYgKHR5cGVvZiByID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJpbnZhbGlkIHNlYSBkYXRhXCIpO1xuICAgIH1cbiAgICByZXR1cm4gdW5wYWNrKHIsIGtleSwgZGF0YSk7XG4gIH0pO1xuXG5jb25zdCB2YWxpZGF0ZVNlYVByb3BlcnR5ID0gYWp2ID0+IChcbiAgc2NoZW1hLFxuICBkYXRhLFxuICBwU2NoZW1hLFxuICBjUGF0aCxcbiAgcGFyZW50RGF0YSxcbiAga2V5SW5QYXJlbnRcbikgPT4ge1xuICBjb25zdCBzb3VsID0gcGF0aChbXCJfXCIsIFwiI1wiXSwgcGFyZW50RGF0YSk7XG5cbiAgaWYgKGtleUluUGFyZW50ID09PSBcIl9cIikgcmV0dXJuIHRydWU7XG4gIGNvbnN0IHsgYXV0aG9ySWQgfSA9XG4gICAgc2VhU291bFJvdXRlLm1hdGNoKHNvdWwpIHx8IHNlYUF1dGhvclJvdXRlLm1hdGNoKHNvdWwpIHx8IHt9O1xuXG4gIGlmICghYXV0aG9ySWQpIHJldHVybiBmYWxzZTtcbiAgaWYgKHNvdWwgPT09IGB+JHthdXRob3JJZH1gICYmIGtleUluUGFyZW50ID09PSBcInB1YlwiKSB7XG4gICAgcmV0dXJuIGRhdGEgPT09IGF1dGhvcklkO1xuICB9XG5cbiAgLy8gVmFsaWRhdGUgYXMgYW4gb2JqZWN0IHRvIGdpdmUgcHJvcGVydHkgdmFsaWRhdG9ycyBtb3JlIGNvbnRleHRcbiAgY29uc3QgdmFsaWRhdGUgPSBhanYuY29tcGlsZSh7XG4gICAgYWRkaXRpb25hbFByb3BlcnRpZXM6IHRydWUsXG4gICAgcHJvcGVydGllczoge1xuICAgICAgW2tleUluUGFyZW50XTogc2NoZW1hXG4gICAgfVxuICB9KTtcbiAgbGV0IHJlc3VsdDtcblxuICByZXR1cm4gcmVhZChwYXJlbnREYXRhLCBrZXlJblBhcmVudCwgYXV0aG9ySWQpXG4gICAgLnRoZW4ocmVzID0+IChyZXN1bHQgPSByZXMpKVxuICAgIC50aGVuKHJlcyA9PiBhc3NvYyhrZXlJblBhcmVudCwgcmVzLCBwYXJlbnREYXRhKSlcbiAgICAuY2F0Y2goZXJyID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJrZXkgZXJyXCIsIHNvdWwsIGtleUluUGFyZW50LCBlcnIuc3RhY2sgfHwgZXJyKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9KVxuICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICBpZiAoIXJlcykge1xuICAgICAgICBkZWxldGUgcGFyZW50RGF0YVtrZXlJblBhcmVudF07XG4gICAgICAgIGRlbGV0ZSAocGF0aChbXCJfXCIsIFwiPlwiXSwgcGFyZW50RGF0YSkgfHwge30pW2tleUluUGFyZW50XTtcbiAgICAgICAgY29uc29sZS5lcnJvcihcInNlYSBwcm9wIGVyclwiLCBzb3VsLCBrZXlJblBhcmVudCwgcmVzdWx0LCBwU2NoZW1hKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH1cbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUodmFsaWRhdGUoKSkudGhlbihpc1ZhbGlkID0+IHtcbiAgICAgICAgaWYgKCFpc1ZhbGlkKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICAgIFwic2VhIHZhbGlkYXRpb24gZXJyXCIsXG4gICAgICAgICAgICBzb3VsLFxuICAgICAgICAgICAga2V5SW5QYXJlbnQsXG4gICAgICAgICAgICByZXN1bHQsXG4gICAgICAgICAgICB2YWxpZGF0ZS5lcnJvcnMsXG4gICAgICAgICAgICBwU2NoZW1hXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNWYWxpZDtcbiAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGluaXRBanYgPSBjb21wb3NlKFxuICBhanYgPT4ge1xuICAgIGFqdi5hZGRLZXl3b3JkKFwic2VhXCIsIHtcbiAgICAgIGFzeW5jOiB0cnVlLFxuICAgICAgbW9kaWZ5aW5nOiB0cnVlLFxuICAgICAgdmFsaWRhdGU6IHZhbGlkYXRlU2VhUHJvcGVydHkoYWp2KVxuICAgIH0pO1xuICAgIHJldHVybiBhanY7XG4gIH0sXG4gIGFqdkJhc2VJbml0XG4pO1xuIiwidmFyIGc7XG5cbi8vIFRoaXMgd29ya3MgaW4gbm9uLXN0cmljdCBtb2RlXG5nID0gKGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcztcbn0pKCk7XG5cbnRyeSB7XG5cdC8vIFRoaXMgd29ya3MgaWYgZXZhbCBpcyBhbGxvd2VkIChzZWUgQ1NQKVxuXHRnID0gZyB8fCBuZXcgRnVuY3Rpb24oXCJyZXR1cm4gdGhpc1wiKSgpO1xufSBjYXRjaCAoZSkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIHRoZSB3aW5kb3cgcmVmZXJlbmNlIGlzIGF2YWlsYWJsZVxuXHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gXCJvYmplY3RcIikgZyA9IHdpbmRvdztcbn1cblxuLy8gZyBjYW4gc3RpbGwgYmUgdW5kZWZpbmVkLCBidXQgbm90aGluZyB0byBkbyBhYm91dCBpdC4uLlxuLy8gV2UgcmV0dXJuIHVuZGVmaW5lZCwgaW5zdGVhZCBvZiBub3RoaW5nIGhlcmUsIHNvIGl0J3Ncbi8vIGVhc2llciB0byBoYW5kbGUgdGhpcyBjYXNlLiBpZighZ2xvYmFsKSB7IC4uLn1cblxubW9kdWxlLmV4cG9ydHMgPSBnO1xuIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18yX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX18zX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX180X187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX181X187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX182X187Il0sInNvdXJjZVJvb3QiOiIifQ==